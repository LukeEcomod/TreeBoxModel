
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Description of the modelled system &#8212; Tree Box Model 0.3 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Instructions to run the model" href="instructions_to_run.html" />
    <link rel="prev" title="Tree Box Model documentation" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="instructions_to_run.html" title="Instructions to run the model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Tree Box Model documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Tree Box Model 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="description-of-the-modelled-system">
<h1>Description of the modelled system<a class="headerlink" href="#description-of-the-modelled-system" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><img alt="Modelled system" src="_images/modelled_system.png" /></p>
<p>Modelled system is a 2-dimensional array representation of a tree. Each property of the tree is saved in a NumPy array.
The first column in each array represents values of the xylem and the second column values of the phloem.
The rows of the arrays represent vertical elements in the tree. The height of an element (l<sub>i</sub>) is calculated
from the input total tree height (H) and number of elements (N)</p>
<p>$$l_i = \frac{H}{N}$$</p>
<p>The height of an element does not change during the simulation.</p>
<p>The row numbering of the arrays starts from the top of the tree (i=0) and ends in the bottom of the tree (i=N).</p>
<p>The number of elements that transpire, produce or unload sugar can be changed by the user. Currently only the bottommost
element takes up water from the soil. The model is build with the idea, that the sap in both xylem and phloem can contain
any number of soluts. However, currently functionality to set, retrieve and update solutes is limited only to sugar (sucrose)
in the phloem.</p>
</div>
<div class="section" id="input-and-output-of-the-model">
<h2>Input and output of the model<a class="headerlink" href="#input-and-output-of-the-model" title="Permalink to this headline">¶</a></h2>
<p><img alt="Model input and output" src="_images/model_input_output.png" /></p>
<p>See <a class="reference internal" href="instructions_to_run.html"><span class="doc">instructions how to run the model</span></a> how to give the input to the model.</p>
</div>
<div class="section" id="the-fluxes-inside-the-tree">
<h2>The fluxes inside the tree<a class="headerlink" href="#the-fluxes-inside-the-tree" title="Permalink to this headline">¶</a></h2>
<p><img alt="Fluxes" src="_images/fluxes.png" /></p>
<p>The fluxes shown in the figure above are calculated as follows (the index i refers to rows in any 2D property array in the model). The fluxes are in the units (kg/s)</p>
<p>$$ Q_{ax,i} = Q_{ax,bottom,i} + Q_{ax,top,i} - E_i$$</p>
<p>$$ Q_{ax,bottom,i} = \frac{k_i \: A_{ax,i} \: \rho_w}{\eta_i \: l_i}(P_{i+1} - P_{i} - P_h) $$</p>
<p>$$ Q_{ax,top,i} = \frac{k_i \: A_{ax,i+1} \: \rho_w}{\eta_i \: l_i}(P_{i-1} - P_{i} + P_h) $$</p>
<p>$$ Q_{radial,phloem} = L_r A_{rad,i} \rho_{w} [P_{i,xylem} - P_{i,phloem} - \sigma(C_{i,xylem} - C_{i,phloem}) R T)] $$</p>
<p>$$ Q_{radial,xylem} = -Q_{radial,phloem} $$</p>
<p>where</p>
<ul class="simple">
<li><p>E<sub>i</sub>: transpiration rate of the ith element (kg/s)</p></li>
<li><p>k<sub>i</sub>: axial permeability of the ith element (m<sup>2</sup>)</p></li>
<li><p>A<sub>ax,i</sub>: base surface area of xylem or phloem (m<sup>2</sup>)</p></li>
<li><p>ρ<sub>w</sub>: liquid phase density of water (kg/m<sup>3</sup>)</p></li>
<li><p>η: viscosity of the sap in the ith element (Pa s)</p></li>
<li><p>l<sub>i</sub>: length (height) of the ith element (m)</p></li>
<li><p>P<sub>i</sub>: Pressure in the ith element (Pa)</p></li>
<li><p>P<sub>h</sub>: Hydrostatic pressure (Pa) - P<sub>h</sub> = ρ<sub>w</sub> a<sub>gravitation</sub> l<sub>i</sub></p></li>
<li><p>L<sub>r</sub>: radial hydraulic conductivity (m/Pa/s)</p></li>
<li><p>A<sub>rad,i</sub>: lateral surface area of the xylem (m<sup>2</sup>)</p></li>
<li><p>σ: reflection coefficient (Van’t hoff factor) (unitless)</p></li>
<li><p>C<sub>i</sub>: sugar concentration in the ith element (mol/m<sup>3</sup>)</p></li>
<li><p>R: universal gas constant (J/K/mol)</p></li>
<li><p>T: ambient temperature (K)</p></li>
</ul>
</div>
<div class="section" id="the-change-of-pressure-sugar-concentration-and-element-radius-due-to-sap-flux">
<h2>The change of pressure, sugar concentration and element radius due to sap flux<a class="headerlink" href="#the-change-of-pressure-sugar-concentration-and-element-radius-due-to-sap-flux" title="Permalink to this headline">¶</a></h2>
<p>The equations are calcualted based on <a class="reference external" href="https://link.springer.com/article/10.1007/s00468-005-0014-6">Hölttä et al., (2006)</a></p>
<p>The change of pressure in the xylem and the phloem due to sap flux is calculated separately for both horizontal elements according to</p>
<p>$$ \frac{\text{d}P_i}{\text{d}t} = \frac{\varepsilon_i}{V_i \rho_w}(Q_{ax,i}+Q_{rad,i}) $$</p>
<p>The change in sugar concentration in the phloem is calculated according to</p>
<p>$$ \frac{\text{d}C_i}{\text{d}t} = \frac{Q_{ax,i}}{V_i} \left(\frac{C_i}{\rho_w} + L_i + U_i \right) $$</p>
<p>The change in element radius in the xylem is calculated according to</p>
<p>$$ \frac{\text{d}R_{xylem,i}}{\text{d}t} = \frac{Q_{ax,i} + Q_{rad,i}}{2 \pi \rho_w l_i (R_{xylem,i}+R_{heartwood})} $$</p>
<p>The change in element radius in the phloem is calculated according to</p>
<p>$$ \frac{\text{d}R_{i,phloem}}{\text{d}t} = \frac{Q_{ax,i} + Q_{rad,i}}{2 \pi \rho_w l_i} \left( \frac{1}{\Sigma_{j=1}^3 R_{j,i}} - \frac{R_{phloem,i}}{(\Sigma_{j=1}^2 R_{j,i})(\Sigma_{j=1}^3 R_{j,i}} \right) $$</p>
<p>where the sum goes from j=1 (the heartwood) to j=3 (the phloem)</p>
<ul class="simple">
<li><p>ϵ<sub>i</sub>: elastic modulus of the ith element (Pa)</p></li>
<li><p>V<sub>i</sub>: volume of the ith element (m<sup>3</sup>)</p></li>
<li><p>L<sub>i</sub>: sugar loading rate of the ith element (mol/s)</p></li>
<li><p>U<sub>i</sub>: sugar unloading rate of the ith element (mol/s)</p></li>
<li><p>ρ<sub>w</sub>: liquid phase density of water (kg/m<sup>3</sup>)</p></li>
<li><p>l<sub>i</sub>: length (height) of the ith element (m)</p></li>
<li><p>C<sub>i</sub>: Sucrose concentration in the ith element (mol/m<sup>3</sup>)</p></li>
<li><p>Q<sub>ax/rad,i</sub>: axial or radial sap flux of the ith element (kg/s)</p></li>
<li><p>R<sub>i</sub>: radius of the ith element (m)</p></li>
<li><p>P<sub>i</sub>: pressure in the ith element (Pa)</p></li>
</ul>
</div>
<div class="section" id="sugar-loading-and-unloading-rates">
<h2>Sugar loading and unloading rates<a class="headerlink" href="#sugar-loading-and-unloading-rates" title="Permalink to this headline">¶</a></h2>
<p>Currently in the model the sugar loading rate should be set equal to the photosynthesis rate when the tree is created.</p>
<p>The initial unloading rate needs to be set but it is updated according to
<a class="reference external" href="https://academic.oup.com/aob/article/114/4/653/2769025">Nikinmaa et. al., (2014)</a></p>
<p>$$ U_i = A_{rad,i} \max{ [0, u_s (C_i - C_0)]}$$</p>
<p>where</p>
<ul class="simple">
<li><p>A<sub>rad,i</sub>: radial surface area between the xylem and the phloem (i.e., lateral area of the xylem)</p></li>
<li><p>u<sub>s</sub>: sugar unloading slope set</p></li>
<li><p>C<sub>i</sub>: sugar concentration in the ith element</p></li>
<li><p>C<sub>0</sub>: sugar target concentration</p></li>
</ul>
</div>
<div class="section" id="how-the-element-radii-are-modelled">
<h2>How the element radii are modelled<a class="headerlink" href="#how-the-element-radii-are-modelled" title="Permalink to this headline">¶</a></h2>
<p><img alt="Tree dimension" src="_images/tree.png" /></p>
<p>The radius of each horizontal element (heartwood, xylem and phloem) are given as the width of the element.
For example, <strong>given total tree diameter of 10 cm, heartwood radius of 2 cm and 90/10% split between the phloem
and the xylem</strong>. The traditional radii of each element (distance from the pith) would be</p>
<ul class="simple">
<li><p>Heartwood: 2 cm</p></li>
<li><p>Xylem: 4.7 cm</p></li>
<li><p>Phloem 5 cm</p></li>
</ul>
<p><strong>In the model the radiis are given as the width of the horizontal element, i.e.:</strong></p>
<ul class="simple">
<li><p>Heartwood: 2 cm</p></li>
<li><p>Xylem: 2.7 cm</p></li>
<li><p>Phloem: 0.3 cm</p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Description of the modelled system</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#input-and-output-of-the-model">Input and output of the model</a></li>
<li><a class="reference internal" href="#the-fluxes-inside-the-tree">The fluxes inside the tree</a></li>
<li><a class="reference internal" href="#the-change-of-pressure-sugar-concentration-and-element-radius-due-to-sap-flux">The change of pressure, sugar concentration and element radius due to sap flux</a></li>
<li><a class="reference internal" href="#sugar-loading-and-unloading-rates">Sugar loading and unloading rates</a></li>
<li><a class="reference internal" href="#how-the-element-radii-are-modelled">How the element radii are modelled</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Tree Box Model documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="instructions_to_run.html"
                        title="next chapter">Instructions to run the model</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modelled_system.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="instructions_to_run.html" title="Instructions to run the model"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Tree Box Model documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Tree Box Model 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Olli-Pekka Tikkanen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>