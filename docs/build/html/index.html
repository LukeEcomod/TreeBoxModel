
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Tree Box Model documentation &#8212; Tree Box Model 0.3 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Description of the modelled system" href="modelled_system.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelled_system.html" title="Description of the modelled system"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Tree Box Model 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tree-box-model-documentation">
<h1>Tree Box Model documentation<a class="headerlink" href="#tree-box-model-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Details of the model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modelled_system.html">Description of the modelled system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#input-and-output-of-the-model">Input and output of the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#the-fluxes-inside-the-tree">The fluxes inside the tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#the-change-of-pressure-sugar-concentration-and-element-radius-due-to-sap-flux">The change of pressure, sugar concentration and element radius due to sap flux</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#sugar-loading-and-unloading-rates">Sugar loading and unloading rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelled_system.html#how-the-element-radii-are-modelled">How the element radii are modelled</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="instructions_to_run.html">Instructions to run the model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="instructions_to_run.html#running-from-main-py">Running from main.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="instructions_to_run.html#importing-src-model">Importing src.model</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="download-the-source">
<h3>Download the source<a class="headerlink" href="#download-the-source" title="Permalink to this headline">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">LukeEcomod</span><span class="o">/</span><span class="n">TreeBoxModel</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>or</p>
<p>download the source <a class="reference external" href="https://github.com/LukeEcomod/TreeBoxModel">https://github.com/LukeEcomod/TreeBoxModel</a></p>
</div>
<div class="section" id="install-the-required-packages">
<h3>Install the required packages<a class="headerlink" href="#install-the-required-packages" title="Permalink to this headline">¶</a></h3>
<p>Ideally you have created a new virtual environment for this project.</p>
<p>To install all the packages required for the model to run use</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>or</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conda</span> <span class="n">install</span> <span class="o">--</span><span class="n">file</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>run main.py</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="module-main">
<span id="main-py"></span><h2>main.py<a class="headerlink" href="#module-main" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this main file is to provide an easy way to run the model.</p>
<p>All the model parameters are set in the file and are taken from
<a class="reference external" href="https://link.springer.com/article/10.1007/s00468-005-0014-6">Hölttä et. al. 2006</a>
or <a class="reference external" href="https://academic.oup.com/aob/article/114/4/653/2769025">Nikinmaa et. al., (2014)</a>.</p>
<p>A sine-like behaviour is assumed for the transpiration and photosynthesis</p>
<a class="reference external image-reference" href="../../source/_static/transpiration_rate.png"><img alt="Transpiration rate" src="../../source/_static/transpiration_rate.png" /></a>
</div>
<div class="section" id="module-src.model">
<span id="modules-classes-functions"></span><h2>Modules, Classes &amp; functions<a class="headerlink" href="#module-src.model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="src.model.Model">
<em class="property">class </em><code class="sig-prename descclassname">src.model.</code><code class="sig-name descname">Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tree</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#src.tree.Tree" title="src.tree.Tree">src.tree.Tree</a></span></em>, <em class="sig-param"><span class="n">outputfile</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'a.nc'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the next time step for given tree and saves the tree stage.</p>
<p>Provides functionality for solving the ordinary differential equations (ODE) describing
the behaviour of the <a class="reference external" href="modelled_system.html">modelled system</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#src.tree.Tree" title="src.tree.Tree"><em>Tree</em></a>) – instance of the tree class for which the ODEs are solved</p></li>
<li><p><strong>outputfile</strong> (<em>str</em>) – name of the file where the NETCDF4 output is written</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="src.model.Model.tree">
<code class="sig-name descname">tree</code><a class="headerlink" href="#src.model.Model.tree" title="Permalink to this definition">¶</a></dt>
<dd><p>instance of the tree class for which the ODEs are solved</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.tree.Tree" title="src.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.model.Model.ncf">
<code class="sig-name descname">ncf</code><a class="headerlink" href="#src.model.Model.ncf" title="Permalink to this definition">¶</a></dt>
<dd><p>the output file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>netCDF4.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.model.Model.axial_fluxes">
<code class="sig-name descname">axial_fluxes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.model.Model.axial_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates axial sap mass flux for every element.</p>
<p>The axial flux in the xylem and phloem are calculated independently from the sum of bottom and top fluxes</p>
<div class="math notranslate nohighlight">
\[Q_{ax,i} = Q_{ax,bottom,i} + Q_{ax,top,i} - E\]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Q_{ax,bottom,i} = \frac{k_i \: A_{ax,i} \: \rho_w}{\eta_i \: l_i}(P_{i+1} - P_{i} - P_h)\\Q_{ax,top,i} = \frac{k_i \: A_{ax,i+1} \: \rho_w}{\eta_i \: l_i}(P_{i-1} - P_{i} + P_h)\end{aligned}\end{align} \]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_i\)</span>: transpiration rate of the ith element (<span class="math notranslate nohighlight">\(\frac{kg}{s}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_i\)</span>: axial permeability of the ith element (<span class="math notranslate nohighlight">\(m^2\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(A_{ax,i}\)</span>: base surface area of xylem or phloem (<span class="math notranslate nohighlight">\(m^2\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_w\)</span>: liquid phase density of water (<span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta\)</span>: viscosity of the sap in the ith element (<span class="math notranslate nohighlight">\(Pa \: s\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(l_i\)</span>: length (height) of the ith element (<span class="math notranslate nohighlight">\(m\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{i}\)</span>: Pressure in the ith element (<span class="math notranslate nohighlight">\(Pa\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_h\)</span>: Hydrostatic pressure (<span class="math notranslate nohighlight">\(Pa\)</span>) <span class="math notranslate nohighlight">\(P_h = \rho_w a_{gravitation} l_i\)</span></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>numpy.ndarray (dtype=float, ndim=2)[self.tree.num_elements, 2]</em> – The axial fluxes in units kg/s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.model.Model.radial_fluxes">
<code class="sig-name descname">radial_fluxes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.model.Model.radial_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates radial sap mass flux for every element.</p>
<p>The radial flux for the phloem of the ith axial is calculated similar to
<a class="reference external" href="https://link.springer.com/article/10.1007/s00468-005-0014-6">Hölttä et. al. 2006</a></p>
<div class="math notranslate nohighlight">
\[Q_{radial,phloem} = L_r A_{rad,i}\rho_{w}
[P_{i,xylem} - P_{i,phloem} - \sigma(C_{i,xylem} - C_{i,phloem})RT)]\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L_r\)</span>: radial hydraulic conductivity (<span class="math notranslate nohighlight">\(\frac{m}{Pa \: s}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(A_{rad,i}\)</span>: lateral surface area of the xylem (<span class="math notranslate nohighlight">\(m^2\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_w\)</span>: liquid phase density of water (<span class="math notranslate nohighlight">\(\frac{kg}{m^3}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{i}\)</span>: Pressure in the ith element (<span class="math notranslate nohighlight">\(Pa\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span>: Reflection coefficient (Van’t hoff factor) (unitless)</p></li>
<li><p><span class="math notranslate nohighlight">\(C_{i}\)</span>: Sucrose concentration in the ith element (<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span>: Universal gas constant (<span class="math notranslate nohighlight">\(\frac{J}{K \: mol}\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span>: Ambient temperature (<span class="math notranslate nohighlight">\(K\)</span>)</p></li>
</ul>
<p>The radial flux for the xylem is equal to the additive inverse of the phloem flux</p>
<div class="math notranslate nohighlight">
\[Q_{radial,xylem} = -Q_{radial,phloem}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>numpy.ndarray (dtype=float, ndim=2)[self.tree.num_elements, 2]</em> – The radial fluxes in units kg/s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.model.Model.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_start</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">time_end</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">120.0</span></em>, <em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">output_interval</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">60</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.model.Model.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the tree in time using explicit Euler method (very slow).</p>
<p>NB! This function needs to be updated. Use run_scipy instead!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_start</strong> (<em>float</em>) – Time in seconds where to start the simulation.</p></li>
<li><p><strong>time_ned</strong> (<em>float</em>) – Time in seconds where to end the simulation.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step in seconds</p></li>
<li><p><strong>output_interval</strong> – Time interval in seconds when to save the tree stage</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.model.Model.run_scipy">
<code class="sig-name descname">run_scipy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_start</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">time_end</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">120.0</span></em>, <em class="sig-param"><span class="n">ind</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.model.Model.run_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the tree in time using the solve_ivp function in the SciPy package.</p>
<p>The stage of the tree is saved only at the start of the simulation if time_start &lt; 1e-3 and at time_end.
If the tree stage is desired on multiple time points the function needs to be called recurrently by splitting
the time interval into multiple sub intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_start</strong> (<em>float</em>) – Time in seconds where to start the simulation.</p></li>
<li><p><strong>time_ned</strong> (<em>float</em>) – Time in seconds where to end the simulation.</p></li>
<li><p><strong>ind</strong> (<em>int</em>) – index which refers to the index in model.outputfile.
The last stage of the tree is saved to model.outputfile[ind].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-src.tree"></span><dl class="py class">
<dt id="src.tree.Tree">
<em class="property">class </em><code class="sig-prename descclassname">src.tree.</code><code class="sig-name descname">Tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">initial_radius</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">num_elements</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">transpiration_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">photosynthesis_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sugar_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sugar_loading_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sugar_unloading_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sugar_target_concentration</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">sugar_unloading_slope</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">axial_permeability_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">radial_hydraulic_conductivity_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">elastic_modulus_profile</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">ground_water_potential</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.tree.Tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Model of a tree.</p>
<p>Provides properties and functionality for saving and editing the modelled tree. Arguments whose
type is List[float] or List[List[float]] are converted to numpy.ndarray with numpy.asarray method.
Thus, also numpy.ndarray is a valid type for these arguments.</p>
<p>For arguemnts whose type is List[float] (except for initial_radius) the length of the arguments must
be equal to num_elements. The order of the list should be from the top of the tree (the first item) to the
bottom of the tree (the last item)</p>
<p>For arguments whose type is List[List[float]] the length of the arguemnts must be equal to num_elements
and each sub list must contain two elements, one for the xylem and one for the phloem in this order. The
order of the sub lists should be from the top of the tree (the first sub list) to the bottom of the tree
(the last sub list).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>height</strong> (<em>float</em>) – total tree height (<span class="math notranslate nohighlight">\(m\)</span>)</p></li>
<li><p><strong>initial_radius</strong> (<em>List</em><em>[</em><em>float</em><em>] or </em><em>numpy.ndarray</em>) – <p>the radius of the xylem and the phloem (<span class="math notranslate nohighlight">\(m\)</span>) in this order.
See from the <a class="reference external" href="modelled_system.html">modelled system</a>, how the radii should be given. Only two values can
be given and the radius of each element is set to be the same in the tree initialization.</p>
</p></li>
<li><p><strong>num_elements</strong> (<em>int</em>) – number of vertical elemenets in the tree.
The height of an element is determined by
<span class="math notranslate nohighlight">\(\text{element height} = \frac{\text{tree height}}{\text{number of elements}}\)</span></p></li>
<li><p><strong>transpiration_profile</strong> (<em>List</em><em>[</em><em>float</em><em>] or </em><em>numpy.ndarray</em>) – The rate of transpiration (<span class="math notranslate nohighlight">\(\frac{kg}{s}\)</span>) in the
xylem. The length of the list must be equal to num_elements and the order is from the top of the tree
(first value) in the list to the bottom of the tree (last value in the list).</p></li>
<li><p><strong>photosynthesis_profile</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The rate of photosynthesis (<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>). Currently this
variable is not used and the rate of photosynthesis should be equal to the sugar_loading_profile.</p></li>
<li><p><strong>sugar_profile</strong> (<em>List</em><em>[</em><em>float</em><em>]</em><em>] or </em><em>numpy.ndarray</em>) – The initial sugar (sucrose) concentration in the phloem
(<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>)</p></li>
<li><p><strong>sugar_loading_profile</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>] or </em><em>numpy.ndarray</em>) – the rate at which sugar concentration increases
in each phloem element (<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>)</p></li>
<li><p><strong>sugar_unloading_profile</strong> (<em>List</em><em>[</em><em>float</em><em>] or </em><em>numpy.ndarray</em>) – The initial sugar unloading rate (the rate at which the
sugar concentration decreases in a given phloem element) (<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>). The unloading rate is
updated in <a class="reference external" href="index.html#src.odefun.odefun">src.odefun.odefun</a>.</p></li>
<li><p><strong>sugar_target_concentration</strong> (<em>float</em>) – the target concentration after which the sugar unloading
starts (<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>)</p></li>
<li><p><strong>sugar_unloading_slope</strong> (<em>float</em>) – <p>the slope parameter for unloading (see
<a class="reference external" href="https://academic.oup.com/aob/article/114/4/653/2769025">Nikinmaa et. al., (2014)</a>).</p>
</p></li>
<li><p><strong>axial_permeability_profile</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>] or </em><em>numpy.ndarray</em>) – axial permeabilities of both xylem and phloem
(<span class="math notranslate nohighlight">\(m^2\)</span>)</p></li>
<li><p><strong>radial_hydraulic_conductivity_profile</strong> (<em>List</em><em>[</em><em>float</em><em>]</em><em>] or </em><em>numpy.ndarray</em>) – radial hydraulic conductivity between the
xylem and the phloem (<span class="math notranslate nohighlight">\(\frac{m}{Pa \: s}\)</span>)</p></li>
<li><p><strong>elastic_modulus_profile</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>] or </em><em>numpy.ndarray</em>) – Elastic modulus of every element (<span class="math notranslate nohighlight">\(Pa\)</span>).</p></li>
<li><p><strong>ground_water_potential</strong> (<em>float</em>) – The water potential in the soil. This is used to calculate the sap flux between
soil and the bottom xylem element.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="src.tree.Tree.height">
<code class="sig-name descname">height</code><a class="headerlink" href="#src.tree.Tree.height" title="Permalink to this definition">¶</a></dt>
<dd><p>total tree height (<span class="math notranslate nohighlight">\(m\)</span>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.num_elements">
<code class="sig-name descname">num_elements</code><a class="headerlink" href="#src.tree.Tree.num_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>number of vertical elemenets in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.transpiration_rate">
<code class="sig-name descname">transpiration_rate</code><a class="headerlink" href="#src.tree.Tree.transpiration_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>The rate of transpiration
(<span class="math notranslate nohighlight">\(\frac{kg}{s}\)</span>) in the xylem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.photosynthesis_rate">
<code class="sig-name descname">photosynthesis_rate</code><a class="headerlink" href="#src.tree.Tree.photosynthesis_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>The rate of photosynthesis
(<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>). Currently this variable is not used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.sugar_loading_rate">
<code class="sig-name descname">sugar_loading_rate</code><a class="headerlink" href="#src.tree.Tree.sugar_loading_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>The rate at which sugar
concentration increases in each phloem element (<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.sugar_unloading_rate">
<code class="sig-name descname">sugar_unloading_rate</code><a class="headerlink" href="#src.tree.Tree.sugar_unloading_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>The rate at which the
sugar concentration decreases in a given phloem element (<span class="math notranslate nohighlight">\(\frac{mol}{s}\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.sugar_target_concentration">
<code class="sig-name descname">sugar_target_concentration</code><a class="headerlink" href="#src.tree.Tree.sugar_target_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>The target concentration after which the sugar unloading
starts (<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.sugar_unloading_slope">
<code class="sig-name descname">sugar_unloading_slope</code><a class="headerlink" href="#src.tree.Tree.sugar_unloading_slope" title="Permalink to this definition">¶</a></dt>
<dd><p>The slope parameter for unloading (see
[Nikinmaa et. al., (2014)](<a class="reference external" href="https://academic.oup.com/aob/article/114/4/653/2769025">https://academic.oup.com/aob/article/114/4/653/2769025</a>)).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.solutes">
<code class="sig-name descname">solutes</code><a class="headerlink" href="#src.tree.Tree.solutes" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of
src.solute.Solute which contain the solutes in the sap of xylem and phloem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=src.solute.Solute, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.axial_permeability">
<code class="sig-name descname">axial_permeability</code><a class="headerlink" href="#src.tree.Tree.axial_permeability" title="Permalink to this definition">¶</a></dt>
<dd><p>Axial permeabilities of both
xylem and phloem (<span class="math notranslate nohighlight">\(m^2\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.radial_hydraulic_conductivity">
<code class="sig-name descname">radial_hydraulic_conductivity</code><a class="headerlink" href="#src.tree.Tree.radial_hydraulic_conductivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial hydraulic
conductivity between the xylem and the phloem (<span class="math notranslate nohighlight">\(\frac{m}{Pa \: s}\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.elastic_modulus">
<code class="sig-name descname">elastic_modulus</code><a class="headerlink" href="#src.tree.Tree.elastic_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p>Elastic modulus of every element
(<span class="math notranslate nohighlight">\(Pa\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.ground_water_potential">
<code class="sig-name descname">ground_water_potential</code><a class="headerlink" href="#src.tree.Tree.ground_water_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>The water potential in the soil.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.pressure">
<code class="sig-name descname">pressure</code><a class="headerlink" href="#src.tree.Tree.pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Pressure of each element (<span class="math notranslate nohighlight">\(Pa\)</span>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.element_radius">
<code class="sig-name descname">element_radius</code><a class="headerlink" href="#src.tree.Tree.element_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Radius of each element (<span class="math notranslate nohighlight">\(m\)</span>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.element_height">
<code class="sig-name descname">element_height</code><a class="headerlink" href="#src.tree.Tree.element_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Height of each element (<span class="math notranslate nohighlight">\(m\)</span>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="src.tree.Tree.viscosity">
<code class="sig-name descname">viscosity</code><a class="headerlink" href="#src.tree.Tree.viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>The dynamic viscosity of each element
(<span class="math notranslate nohighlight">\(Pa \: s\)</span>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray(dtype=float, ndim=2) [tree.num_elements, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.cross_sectional_area">
<code class="sig-name descname">cross_sectional_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ind</span><span class="p">:</span> <span class="n">List<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.tree.Tree.cross_sectional_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the cross-sectional area between the xylemn and the phloem.</p>
<p>The cross sectional area is equal to lateral surface area of the xylem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ind</strong> (<em>List</em><em>[</em><em>int</em><em>] or </em><em>numpy.ndarray</em><em>(</em><em>dtype=int</em><em>, </em><em>ndim=1</em><em>)</em><em>, </em><em>optional</em>) – the indices of the elements
for which the cross-sectinoal area is calculated. If no ind is given, the
cross-sectional area is calculated for every element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>numpy.ndarray(dtype=float, ndim=2) [len(ind) or self.num_elements, 1]</em> – Cross-sectional area
between the xylem and phloem elements (<span class="math notranslate nohighlight">\(m^2\)</span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.element_area">
<code class="sig-name descname">element_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ind</span><span class="p">:</span> <span class="n">List<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">column</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.tree.Tree.element_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the base area of the xylem or the phloem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ind</strong> (<em>List</em><em>[</em><em>int</em><em>] or </em><em>numpy.ndarray</em><em>(</em><em>dtype=int</em><em>, </em><em>ndim=1</em><em>)</em><em>, </em><em>optional</em>) – the indices of the elements
for which the base area is calculated. If no ind is given, the base area is calculated
for every element.</p></li>
<li><p><strong>column</strong> (<em>int</em><em>, </em><em>optional</em>) – The column in the tree grid for which the base area is calculated.
use column=0 for the xylem and column=1 for the phloem. If not column is given returns
the base area for the xylem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>numpy.ndarray(dtype=float, ndim=2) [len(ind) or self.num_elements, 1]</em> – Base area of either
the xylem or the phloem (<span class="math notranslate nohighlight">\(m^2\)</span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.element_volume">
<code class="sig-name descname">element_volume</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ind</span><span class="p">:</span> <span class="n">List<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">column</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.tree.Tree.element_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the volume of the xylem or the phloem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ind</strong> (<em>List</em><em>[</em><em>int</em><em>] or </em><em>numpy.ndarray</em><em>(</em><em>dtype=int</em><em>, </em><em>ndim=1</em><em>)</em><em>, </em><em>optional</em>) – the indices of the elements
for which the volume is calculated. If no ind is given, the volume is calculated
for every element.</p></li>
<li><p><strong>column</strong> (<em>int</em><em>, </em><em>optional</em>) – The column in the tree grid for which the volume is calculated.
use column=0 for the xylem and column=1 for the phloem. If not column is given returns
the volume for the xylem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>numpy.ndarray(dtype=float, ndim=2) [len(ind) or self.num_elements, 1]</em> – Volume of either
the xylem or the phloem (<span class="math notranslate nohighlight">\(m^3\)</span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.sugar_concentration_as_numpy_array">
<code class="sig-name descname">sugar_concentration_as_numpy_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.tree.Tree.sugar_concentration_as_numpy_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the phloem sugar concentration in <a class="reference external" href="index.html#src.tree.Tree.solutes">self.solutes</a>
into numpy.ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>numpy.ndarray(dtype=float, ndim=2) [self.num_elements, 1]</em> – The sugar concentration in the phloem.
(<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.update_sap_viscosity">
<code class="sig-name descname">update_sap_viscosity</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tree.Tree.update_sap_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and sets the viscosity in the phloem according to the sugar concenration.</p>
<p>The sap viscosity is calculated according to Morrison (2002)</p>
<div class="math notranslate nohighlight">
\[\eta = \eta_w \exp{\frac{4.68 \cdot 0.956 \Phi_s}{1-0.956 \Phi_s}}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\eta_w\)</span>: Dynamic viscosity of water (<span class="math notranslate nohighlight">\(\eta_w \approx 0.001\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi_s\)</span>: Volume fraction of sugar (sucrose) in the phloem sap.</p></li>
</ul>
<p class="rubric">References</p>
<p>Morison, Ken R. “Viscosity equations for sucrose solutions: old and new 2002.”
Proceedings of the 9th APCChE Congress and CHEMECA. 2002.</p>
</dd></dl>

<dl class="py method">
<dt id="src.tree.Tree.update_sugar_concentration">
<code class="sig-name descname">update_sugar_concentration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_concentration</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tree.Tree.update_sugar_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the sugar concentration in <a class="reference external" href="index.html#src.tree.Tree.solutes">self.solutes</a> to new_concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_concentration</strong> (<em>numpy.ndarray</em><em>(</em><em>dtype=float</em><em>, </em><em>ndim=2</em><em>)</em><em>[</em><em>self.num_elements</em><em>,</em><em>1</em><em>]</em>) – new concentration values.
the order is from top of the tree (first element, new_concentration[0]) to bottom of the tree
(last element, new_concentration[self.num_elements-1]) (<span class="math notranslate nohighlight">\(\frac{mol}{m^3}\)</span>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-src.solute"></span><dl class="py function">
<dt id="src.odefun.odefun">
<code class="sig-prename descclassname">src.odefun.</code><code class="sig-name descname">odefun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#src.odefun.odefun" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the right hand side of the model ODEs.</p>
<p>The modelled systen and the ODEs are described in the <a class="reference external" href="modelled_system.html">modelled system</a>.
The scipy.solve_ivp() function in src.model.Model.run_scipy() method calls this function during
the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – time in the model simulation</p></li>
<li><p><strong>y</strong> (numpy.ndarray(dtype=float, ndims=1)[5 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements,]) – 1D array where elements
0:2 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements are the pressures in the xylem and phloem of the tree, elements
2 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements:3 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements are for the sucrose
concentration in the phloem and elements 3 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements:5 <span class="math notranslate nohighlight">\(\cdot\)</span>
model.tree.num_elements are for the element radii both in the xylem and the phloem.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#src.model.Model" title="src.model.Model"><em>src.model.Model</em></a>) – Instace of the model class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(numpy.ndarray(dtype=float,ndims=1)[5 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements,]) – 1D array of the right hand side
values of the model ODEs where the elements 0:2 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements are
<span class="math notranslate nohighlight">\(\frac{\text{d(pressure)}}{\text{dt}}\)</span>, elements 2 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements:
3 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements are <span class="math notranslate nohighlight">\(\frac{\text{d[C(sucrose)]}}{\text{dt}}\)</span> and elements
3 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements:5 <span class="math notranslate nohighlight">\(\cdot\)</span> model.tree.num_elements are
<span class="math notranslate nohighlight">\(\frac{\text{d(radius)}}{\text{dt}}\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt id="src.constants.MAX_ELEMENT_COLUMNS">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">MAX_ELEMENT_COLUMNS</code><em class="property">: int</em><em class="property"> = 2</em><a class="headerlink" href="#src.constants.MAX_ELEMENT_COLUMNS" title="Permalink to this definition">¶</a></dt>
<dd><p>Max number of columns in the <a class="reference external" href="index.html#src.tree.Tree">tree</a> class</p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.HEARTWOOD_RADIUS">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">HEARTWOOD_RADIUS</code><em class="property"> = 0.0444</em><a class="headerlink" href="#src.constants.HEARTWOOD_RADIUS" title="Permalink to this definition">¶</a></dt>
<dd><p>The radius of the heartwood <span class="math notranslate nohighlight">\(\left( m \right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.TEMPERATURE">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">TEMPERATURE</code><em class="property">: float</em><em class="property"> = 298.0</em><a class="headerlink" href="#src.constants.TEMPERATURE" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature of the tree <span class="math notranslate nohighlight">\(\left( K \right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.M_WATER">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">M_WATER</code><em class="property">: float</em><em class="property"> = 0.0182</em><a class="headerlink" href="#src.constants.M_WATER" title="Permalink to this definition">¶</a></dt>
<dd><p>Molar mass of water <span class="math notranslate nohighlight">\(\left(\frac{kg}{mol}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.RHO_WATER">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">RHO_WATER</code><em class="property">: float</em><em class="property"> = 1000</em><a class="headerlink" href="#src.constants.RHO_WATER" title="Permalink to this definition">¶</a></dt>
<dd><p>density of liquid water <span class="math notranslate nohighlight">\(\left(\frac{kg}{m^3}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.VISCOSITY_WATER">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">VISCOSITY_WATER</code><em class="property">: float</em><em class="property"> = 0.001</em><a class="headerlink" href="#src.constants.VISCOSITY_WATER" title="Permalink to this definition">¶</a></dt>
<dd><p>dynamic viscosity of water <span class="math notranslate nohighlight">\(\left( Pa \cdot s \right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.M_SUCROSE">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">M_SUCROSE</code><em class="property">: float</em><em class="property"> = 0.3423</em><a class="headerlink" href="#src.constants.M_SUCROSE" title="Permalink to this definition">¶</a></dt>
<dd><p>molar mass of sucrose <span class="math notranslate nohighlight">\(\left(\frac{kg}{mol}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.RHO_SUCROSE">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">RHO_SUCROSE</code><em class="property">: float</em><em class="property"> = 1590.0</em><a class="headerlink" href="#src.constants.RHO_SUCROSE" title="Permalink to this definition">¶</a></dt>
<dd><p>density of sucrose <span class="math notranslate nohighlight">\(\left(\frac{kg}{m^3}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.GRAVITATIONAL_ACCELERATION">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">GRAVITATIONAL_ACCELERATION</code><em class="property">: float</em><em class="property"> = 9.81</em><a class="headerlink" href="#src.constants.GRAVITATIONAL_ACCELERATION" title="Permalink to this definition">¶</a></dt>
<dd><p>acceleration due to Earth’s gravity <span class="math notranslate nohighlight">\(\left(\frac{m}{s^2}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.AVOGADROS_CONSTANT">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">AVOGADROS_CONSTANT</code><em class="property">: float</em><em class="property"> = 6.022e+23</em><a class="headerlink" href="#src.constants.AVOGADROS_CONSTANT" title="Permalink to this definition">¶</a></dt>
<dd><p>avogadro’s constant <span class="math notranslate nohighlight">\(\left(\frac{1}{mol}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.constants.MOLAR_GAS_CONSTANT">
<code class="sig-prename descclassname">src.constants.</code><code class="sig-name descname">MOLAR_GAS_CONSTANT</code><em class="property">: float</em><em class="property"> = 8.3145</em><a class="headerlink" href="#src.constants.MOLAR_GAS_CONSTANT" title="Permalink to this definition">¶</a></dt>
<dd><p>molar gas constant <span class="math notranslate nohighlight">\(\left(\frac{J}{K \cdot mol}\right)\)</span></p>
</dd></dl>

<dl class="py data">
<dt id="src.model_variables">
<code class="sig-prename descclassname">src.</code><code class="sig-name descname">model_variables</code><em class="property"> = Name, descriptions, unit, dimension and precision of each variable that is saved to the netcdf dataset</em><a class="headerlink" href="#src.model_variables" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-src.tools.iotools"></span><dl class="py function">
<dt id="src.tools.iotools.initialize_netcdf">
<code class="sig-prename descclassname">src.tools.iotools.</code><code class="sig-name descname">initialize_netcdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">axial_elements</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">variables</span><span class="p">:</span> <span class="n">Dict</span></em><span class="sig-paren">)</span> &#x2192; netCDF4._netCDF4.Dataset<a class="headerlink" href="#src.tools.iotools.initialize_netcdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a netcdf file to be ready for saving simulation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of the NETCDF4 file that is created</p></li>
<li><p><strong>axial_elements</strong> (<em>int</em>) – Number of axial elements in the Tree</p></li>
<li><p><strong>variables</strong> (<em>Dict</em>) – The names, descriptions, units, dimensions and precision of each variable that is saved
to the netcdf file. The key of each dictionary element is used to label the variables.
The value of each dictionary element needs to be a list where <span class="raw-html-m2r"><br /></span>
list[0] (str) Description of the variable <span class="raw-html-m2r"><br /></span>
list[1] (str): unit of the variable  <span class="raw-html-m2r"><br /></span>
list[2] (Tuple): NETCDF dimensions of the variable  <span class="raw-html-m2r"><br /></span>
list[3] (str): Datatype (precision) of the variable  <span class="raw-html-m2r"><br /></span>
The possible NETCDF dimensions are “index”, “radial_layers” and “axial_layers”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(NETCDF4.Dataset)</em> – A NETCDF4 file where the simulation results can be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.tools.iotools.tree_properties_to_dict">
<code class="sig-prename descclassname">src.tools.iotools.</code><code class="sig-name descname">tree_properties_to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tree</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#src.tree.Tree" title="src.tree.Tree">src.tree.Tree</a></span></em><span class="sig-paren">)</span> &#x2192; Dict<a class="headerlink" href="#src.tools.iotools.tree_properties_to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfers tree properties into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#src.tree.Tree" title="src.tree.Tree"><em>Tree</em></a>) – Instance of the tree class.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(Dict)</em> – Dictionary of the tree properties.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.tools.iotools.write_netcdf">
<code class="sig-prename descclassname">src.tools.iotools.</code><code class="sig-name descname">write_netcdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncf</span><span class="p">:</span> <span class="n">netCDF4._netCDF4.Dataset</span></em>, <em class="sig-param"><span class="n">results</span><span class="p">:</span> <span class="n">Dict</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tools.iotools.write_netcdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a simulation result dictionary into a netcdf file.</p>
<p>The variables that can be written are defined in the src.model_variables file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncf</strong> (<em>netCDF4.Dataset</em>) – the netcdf file where the results are written</p></li>
<li><p><strong>results</strong> (<em>Dict</em>) – the results dictionary. Use the <a class="reference external" href="index.html#src.tools.iotools.tree_properties_to_dict">tree_properties_to_dict</a> function
to create the dictionary.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-src.tools.plotting"></span><dl class="py function">
<dt id="src.tools.plotting.plot_phloem_pressure_top_bottom">
<code class="sig-prename descclassname">src.tools.plotting.</code><code class="sig-name descname">plot_phloem_pressure_top_bottom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tools.plotting.plot_phloem_pressure_top_bottom" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phloem pressure at the top and bottom of the tree.</p>
<p>The figure is saved in the current working directory with the same
name as the filename with “_phloem_pressure.png” appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – name of the NetCDF file in the current directory that
includes the simulation results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.tools.plotting.plot_simulation_results">
<code class="sig-prename descclassname">src.tools.plotting.</code><code class="sig-name descname">plot_simulation_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">foldername</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tools.plotting.plot_simulation_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot sugar concentration, fluxes and pressures from one simulation.</p>
<p>Currently you need edit tha start and end indeces in the code to capture
the correct time window in the simulation results. The indices refer to
the index dimension in the NetCDF files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of the NetCDF file in the current directory that
includes the simulation results.</p></li>
<li><p><strong>foldername</strong> (<em>str</em>) – name of the folder where the figures are saved</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.tools.plotting.plot_variable_vs_time">
<code class="sig-prename descclassname">src.tools.plotting.</code><code class="sig-name descname">plot_variable_vs_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">params</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tools.plotting.plot_variable_vs_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot any variable as a function of time from the NetCDF file that contains the simulation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of the NetCDF file in the current directory that
includes the simulation results.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>, </em><em>optional</em>) – Parameters and instructions for making the plot (see Examples)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>An example of the params dictionary is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;variable_name&#39;</span><span class="p">:</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span>
<span class="s1">&#39;time_divide&#39;</span><span class="p">:</span> <span class="mi">86400</span><span class="p">,</span>
<span class="s1">&#39;variable_divide&#39;</span><span class="p">:</span> <span class="mf">1e6</span>
<span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;middle&#39;</span><span class="p">]],</span>
<span class="s1">&#39;line_colors&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]],</span>
<span class="s1">&#39;line_widths&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
<span class="s1">&#39;cut&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1500</span><span class="p">),</span>
        <span class="s1">&#39;axial_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">39</span><span class="p">],</span>
        <span class="s1">&#39;radial_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
<span class="s1">&#39;xticks&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;Time (d)&#39;</span>
<span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;Pressure (MPa)&#39;</span><span class="p">,</span>
<span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Pressure in the xylem&#39;</span>
<span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="s1">&#39;figure/&#39;</span><span class="p">,</span>
<span class="s1">&#39;filename_ending&#39;</span><span class="p">:</span> <span class="s1">&#39;xylem_pressure.png&#39;</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Variable name is the name of the variable that is to be plotted. The name must equal to a variable
in the NetCDF file</p></li>
<li><p>time_divide is a float which is used to divide the time vector (x-axis) in the plot. e.g., 86400 converts
seconds to days</p></li>
<li><p>variable_divide is a float which is used to divide the variable vector (y-axis) in the plot</p></li>
<li><p>labels are the labels of each line that is drawn</p></li>
<li><p>line_colors are the colors of each line that is drawn</p></li>
<li><p>line_widths are the line widths of each line that is drawn</p></li>
<li><p>cut contains the data range in the NetCDF file that are plotted. The function can handle only
3-dimensional data. If the variable that is plotted has shape (1500,2,1) like in this example,
the function expects that there will be 2*1=3 lines in the plot. Consequently, the labels, line_colors,
and line_widhths values in the params dictionary need to have 3 elements like in this example.</p></li>
<li><p>xticks are the matplotlib.pyplot.xticks function argument</p></li>
<li><p>xlabel is the matplotlib.pyplot.xlabel function argument</p></li>
<li><p>ylabel is the matplotlib.pyplot.ylabel function argument</p></li>
<li><p>title is the matplotlib.pyplot.title function argument</p></li>
<li><p>folder refers to the folder starting from the current working directory where the figure is saved</p></li>
<li><p>filename_ending is a string that is appended to the filename when the figure is saved</p></li>
<li><p>If no folder is specified the argument filename and filename_ending is used to create the name of the figure
that is saved.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="src.tools.plotting.plot_xylem_pressure_top_bottom">
<code class="sig-prename descclassname">src.tools.plotting.</code><code class="sig-name descname">plot_xylem_pressure_top_bottom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#src.tools.plotting.plot_xylem_pressure_top_bottom" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the xylem pressure at the top and bottom of the tree.</p>
<p>The figure is saved in the current working directory with the same
name as the filename with “_xylem_pressure.png” appended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – name of the NetCDF file in the current directory that
includes the simulation results.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tree Box Model documentation</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#download-the-source">Download the source</a></li>
<li><a class="reference internal" href="#install-the-required-packages">Install the required packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-start">Quick start</a></li>
<li><a class="reference internal" href="#module-main">main.py</a></li>
<li><a class="reference internal" href="#module-src.model">Modules, Classes &amp; functions</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="modelled_system.html"
                        title="next chapter">Description of the modelled system</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelled_system.html" title="Description of the modelled system"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Tree Box Model 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Olli-Pekka Tikkanen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>